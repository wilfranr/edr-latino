<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tu compañero definitivo para Elden Ring. Guía completa con jefes, armas, objetos, ubicaciones y misiones en español latino.">
    <meta name="keywords" content="Elden Ring, guía, jefes, armas, objetos, misiones, español, latino">
    <meta name="author" content="Elden Ring Companion">
    <meta name="theme-color" content="#f59e0b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ER Companion">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://wilfranr.github.io/edr-latino/">
    <meta property="og:title" content="Elden Ring Companion - Guía Completa">
    <meta property="og:description" content="Tu compañero definitivo para Elden Ring. Guía completa con jefes, armas, objetos, ubicaciones y misiones en español latino.">
    <meta property="og:image" content="https://wilfranr.github.io/edr-latino/icons/icon-512x512.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://wilfranr.github.io/edr-latino/">
    <meta property="twitter:title" content="Elden Ring Companion - Guía Completa">
    <meta property="twitter:description" content="Tu compañero definitivo para Elden Ring. Guía completa con jefes, armas, objetos, ubicaciones y misiones en español latino.">
    <meta property="twitter:image" content="https://wilfranr.github.io/edr-latino/icons/icon-512x512.png">
    
    <title>Elden Ring Companion - Guía Completa</title>
    
    <!-- PWA Links -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Estilos personalizados Glassmorphism 2.0 -->
    <style>
        /* Variables CSS para Glassmorphism 2.0 */
        :root {
            --glass-bg-primary: #0a0a0f;
            --glass-bg-secondary: #1a1a2e;
            --glass-bg-tertiary: #16213e;
            --glass-accent-amber: #ffd700;
            --glass-accent-emerald: #00ff88;
            --glass-accent-purple: #8b5cf6;
            --glass-accent-blue: #3b82f6;
            --glass-text-primary: #ffffff;
            --glass-text-secondary: #e2e8f0;
            --glass-text-muted: #94a3b8;
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --glass-shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.4);
            --glass-blur: 16px;
            --glass-radius: 16px;
            --glass-radius-small: 12px;
        }

        /* Fondo dinámico con gradientes Aurora */
        body {
            font-family: 'Inter', sans-serif;
            background: var(--glass-bg-primary);
            color: var(--glass-text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Fondo dinámico animado */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(139, 92, 246, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(0, 255, 136, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 60% 40%, rgba(255, 215, 0, 0.2) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 25%, #16213e 50%, #1a1a2e 75%, #0a0a0f 100%);
            animation: auroraFlow 20s ease-in-out infinite;
            z-index: -2;
        }

        /* Animación del fondo Aurora */
        @keyframes auroraFlow {
            0%, 100% {
                transform: translateX(0) translateY(0) scale(1);
                filter: hue-rotate(0deg);
            }
            25% {
                transform: translateX(-2%) translateY(-1%) scale(1.02);
                filter: hue-rotate(10deg);
            }
            50% {
                transform: translateX(1%) translateY(-2%) scale(0.98);
                filter: hue-rotate(-5deg);
            }
            75% {
                transform: translateX(-1%) translateY(1%) scale(1.01);
                filter: hue-rotate(5deg);
            }
        }

        /* Efecto parallax para el fondo */
        .parallax-bg {
            transform: translateZ(-1px) scale(1.1);
            will-change: transform;
        }

        .font-cinzel {
            font-family: 'Cinzel', serif;
        }

        .font-orbitron {
            font-family: 'Orbitron', monospace;
        }

        /* Clases base para elementos de cristal */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius);
            box-shadow: var(--glass-shadow);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            opacity: 0.6;
        }

        .glass-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--glass-shadow-hover);
            background: rgba(255, 255, 255, 0.08);
        }

        .glass-card:active {
            transform: translateY(-2px) scale(0.98);
            backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            -webkit-backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            transition: all 0.1s ease;
        }

        .glass-button {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius-small);
            box-shadow: var(--glass-shadow);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .glass-button:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.12);
            box-shadow: var(--glass-shadow-hover);
        }

        .glass-button:active {
            transform: translateY(1px) scale(0.95);
            backdrop-filter: blur(calc(var(--glass-blur) + 2px));
            -webkit-backdrop-filter: blur(calc(var(--glass-blur) + 2px));
            transition: all 0.1s ease;
        }

        .glass-progress {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius-small);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }

        .glass-progress-bar {
            background: linear-gradient(135deg, var(--glass-accent-amber), var(--glass-accent-emerald));
            border-radius: var(--glass-radius-small);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--glass-radius);
            box-shadow: var(--glass-shadow);
            border: none;
        }

        .glass-nav-button {
            background: transparent;
            border: none;
            border-radius: var(--glass-radius-small);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-nav-button.active {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            -webkit-backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .glass-nav-button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.08);
        }

        .glass-nav-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.15);
        }

        /* Animaciones de entrada */
        @keyframes glassSlideIn {
            0% {
                transform: translateY(30px) scale(0.9);
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
                backdrop-filter: blur(var(--glass-blur));
            }
        }

        @keyframes glassFadeIn {
            0% {
                opacity: 0;
                transform: scale(0.95);
                backdrop-filter: blur(0px);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                backdrop-filter: blur(var(--glass-blur));
            }
        }

        @keyframes glassPress {
            0% {
                transform: scale(1);
                backdrop-filter: blur(var(--glass-blur));
            }
            50% {
                transform: scale(0.95);
                backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            }
            100% {
                transform: scale(1);
                backdrop-filter: blur(var(--glass-blur));
            }
        }

        .glass-slide-in {
            animation: glassSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-fade-in {
            animation: glassFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-press {
            animation: glassPress 0.2s ease-in-out;
        }

        /* Efecto de pulso para feedback */
        @keyframes glassPulse {
            0% {
                box-shadow: var(--glass-shadow);
            }
            50% {
                box-shadow: var(--glass-shadow-hover), 0 0 20px rgba(255, 215, 0, 0.3);
            }
            100% {
                box-shadow: var(--glass-shadow);
            }
        }

        .glass-pulse {
            animation: glassPulse 0.3s ease-in-out;
        }

        /* Checkboxes de cristal */
        .glass-checkbox {
            appearance: none;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .glass-checkbox:checked {
            background: linear-gradient(135deg, var(--glass-accent-amber), var(--glass-accent-emerald));
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        .glass-checkbox:checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }

        /* Títulos expresivos */
        .glass-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            background: linear-gradient(135deg, var(--glass-accent-amber), var(--glass-accent-emerald));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            :root {
                --glass-blur: 12px;
                --glass-radius: 12px;
                --glass-radius-small: 8px;
            }
        }

        /* Navegación inferior fija */
        #bottom-navigation {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border-top: 1px solid var(--glass-border);
            box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.3);
        }

        .bottom-nav-button {
            background: transparent;
            border: none;
            border-radius: var(--glass-radius-small);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            min-width: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
        }

        .bottom-nav-button.active {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            -webkit-backdrop-filter: blur(calc(var(--glass-blur) + 4px));
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .bottom-nav-button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }

        .bottom-nav-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.15);
        }

        /* Ajustar el contenido principal para la navegación inferior */
        .container {
            padding-bottom: 60px; /* Espacio mínimo para la navegación inferior */
        }

        /* Animaciones para las tabs de equipamiento y objetos */
        .equipment-content,
        .items-content {
            transition: all 0.3s ease-in-out;
        }

        .equipment-tab-button,
        .items-tab-button {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Responsive para navegación inferior */
        @media (max-width: 640px) {
            #bottom-navigation {
                padding: 4px;
            }
            
            .bottom-nav-button {
                min-width: 50px;
                padding: 4px 2px;
                justify-content: flex-end;
            }
            
            .bottom-nav-button svg {
                height: 18px;
                width: 18px;
            }
            
            .bottom-nav-button span {
                font-size: 9px;
            }
            
            /* Reducir aún más el espacio en móviles */
            .container {
                padding-bottom: 50px !important;
            }
        }

        /* Responsive para tabs de equipamiento */
        @media (max-width: 768px) {
            .equipment-tab-button {
                padding: 8px 12px;
                font-size: 14px;
            }
            
            .equipment-tab-button span {
                font-size: 10px;
            }
        }

        @media (max-width: 640px) {
            .equipment-tab-button {
                padding: 6px 8px;
                font-size: 12px;
                margin: 0 2px;
            }
            
            .equipment-tab-button span {
                font-size: 9px;
            }
        }

        /* Optimizaciones de rendimiento */
        .glass-card,
        .glass-button,
        .glass-progress {
            will-change: transform, backdrop-filter;
        }
    </style>
</head>
<body>

    <div class="container mx-auto p-2 md:p-6 max-w-6xl">

        <!-- Pantalla de Lista de Jefes -->
        <main id="screen-zones">
            <header class="text-center mb-8">
                <h1 class="glass-title text-4xl font-bold mb-6">Zonas de las Tierras Intermedias</h1>
                <div class="glass-card p-6 max-w-lg mx-auto glass-slide-in">
                    <div class="flex justify-between mb-3">
                        <span class="text-base font-semibold text-amber-400">Progreso General</span>
                        <span id="overall-progress-text" class="text-sm font-semibold text-amber-400">0%</span>
                    </div>
                    <div class="glass-progress w-full h-3">
                        <div id="overall-progress-bar" class="glass-progress-bar h-3" style="width: 0%"></div>
                    </div>
                </div>
            </header>

            <div id="loading-indicator" class="text-center text-amber-400 text-xl py-10 glass-card p-6 max-w-md mx-auto glass-fade-in">Cargando zonas...</div>
            <div id="zone-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Las tarjetas de las zonas se insertarán aquí por JavaScript -->
            </div>
        </main>
        
        <!-- Pantalla de Jefes de Zona (oculta por defecto) -->
        <main id="screen-zone-detail" class="hidden">
            <header class="mb-8">
                <button id="back-to-zones-button" class="glass-button flex items-center text-amber-400 hover:text-amber-300 font-semibold px-4 py-3 glass-fade-in">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    Volver a las Zonas
                </button>
            </header>
            <div class="text-center mb-6">
                <h1 id="zone-detail-title" class="glass-title text-4xl font-bold"></h1>
            </div>

            <!-- Pestañas de navegación -->
            <nav class="glass-nav flex justify-center p-2 mb-8 max-w-2xl mx-auto glass-slide-in">
                <button data-tab="jefes" class="tab-button glass-nav-button active font-semibold text-amber-400 py-3 px-6 mx-1">Jefes <span id="jefes-progress-text" class="text-xs ml-1"></span></button>
                <button data-tab="misiones" class="tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Misiones <span id="misiones-progress-text" class="text-xs ml-1"></span></button>
                <button data-tab="armas" class="tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Armas <span id="armas-progress-text" class="text-xs ml-1"></span></button>
                <button data-tab="objetos" class="tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Objetos <span id="objetos-progress-text" class="text-xs ml-1"></span></button>
            </nav>

            <!-- Contenido de las pestañas -->
            <div id="tab-content-container">
                <div id="tab-jefes" class="tab-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Contenido de Jefes -->
                </div>
                <div id="tab-misiones" class="tab-content hidden space-y-3">
                    <!-- Contenido de Misiones -->
                </div>
                <div id="tab-armas" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Armas -->
                </div>
                <div id="tab-objetos" class="tab-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Objetos -->
                </div>
            </div>
        </main>

        <!-- Pantalla de Detalle de Jefe (oculta por defecto) -->
        <main id="screen-detail" class="hidden">
            <header class="mb-8">
                <button id="back-button" class="glass-button flex items-center text-amber-400 hover:text-amber-300 font-semibold px-4 py-3 glass-fade-in">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    Volver
                </button>
            </header>

            <!-- Contenedor para los detalles del jefe -->
            <div id="detail-content" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <img id="detail-image" src="" alt="Imagen del jefe" class="glass-card w-full h-auto object-cover p-2 glass-slide-in">
                </div>
                <div class="md:col-span-2">
                    <h2 id="detail-name" class="glass-title text-4xl font-bold mb-4"></h2>
                    <p id="detail-description" class="text-zinc-300 mb-6 text-lg leading-relaxed"></p>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-md">
                        <nav class="glass-nav">
                            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                                <h1 class="text-2xl font-bold text-amber-400 font-cinzel">Elden Ring Companion</h1>
                                <div class="flex space-x-4 items-center">
                                    <button id="homeBtn" class="glass-button">Inicio</button>
                                    <button id="bossesBtn" class="glass-button">Jefes</button>
                                    <button id="equipmentBtn" class="glass-button">Equipo</button>
                                    <button id="itemsBtn" class="glass-button">Objetos</button>
                                    <button id="installButton-detail" class="glass-button hidden bg-green-600 hover:bg-green-700">
                                        <span class="flex items-center">
                                            <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                            </svg>
                                            Instalar App
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </nav>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Ubicación</h3>
                            <p id="detail-location" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Puntos de Vida</h3>
                            <p id="detail-health" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Runas Obtenidas</h3>
                            <p id="detail-runes" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Recompensas (Drops)</h3>
                            <ul id="detail-drops" class="list-disc list-inside text-zinc-200"></ul>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-green-400 mb-2">Debilidades</h3>
                            <ul id="detail-weaknesses" class="list-disc list-inside text-zinc-200"></ul>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-red-400 mb-2">Fortalezas</h3>
                            <ul id="detail-strengths" class="list-disc list-inside text-zinc-200"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Pantalla de Detalle de Arma (oculta por defecto) -->
        <main id="screen-weapon-detail" class="hidden">
            <header class="mb-8">
                <button id="back-to-equipment-button" class="glass-button flex items-center text-amber-400 hover:text-amber-300 font-semibold px-4 py-3 glass-fade-in">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    Volver a Equipamiento
                </button>
            </header>

            <!-- Contenedor para los detalles del arma -->
            <div id="weapon-detail-content" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="md:col-span-1">
                    <img id="weapon-detail-image" src="" alt="Imagen del arma" class="glass-card w-full h-auto object-cover p-2 glass-slide-in">
                </div>
                <div class="md:col-span-2">
                    <h2 id="weapon-detail-name" class="glass-title text-4xl font-bold mb-4"></h2>
                    <p id="weapon-detail-description" class="text-zinc-300 mb-6 text-lg leading-relaxed"></p>

                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-md">
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Ubicación</h3>
                            <p id="weapon-detail-location" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Categoría</h3>
                            <p id="weapon-detail-category" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in">
                            <h3 class="font-bold text-amber-500 mb-2">Peso</h3>
                            <p id="weapon-detail-weight" class="text-zinc-200"></p>
                        </div>
                        <div class="glass-card p-4 glass-fade-in col-span-full">
                            <h3 class="font-bold text-amber-500 mb-2">Ataque</h3>
                            <div id="weapon-detail-attack" class="grid grid-cols-2 sm:grid-cols-3 gap-2"></div>
                        </div>
                        <div class="glass-card p-4 glass-fade-in col-span-full">
                            <h3 class="font-bold text-amber-500 mb-2">Defensa</h3>
                            <div id="weapon-detail-defence" class="grid grid-cols-2 sm:grid-cols-3 gap-2"></div>
                        </div>
                         <div class="glass-card p-4 glass-fade-in col-span-full">
                            <h3 class="font-bold text-amber-500 mb-2">Atributos Requeridos</h3>
                            <div id="weapon-detail-required" class="grid grid-cols-2 sm:grid-cols-3 gap-2"></div>
                        </div>
                        <div class="glass-card p-4 glass-fade-in col-span-full">
                            <h3 class="font-bold text-amber-500 mb-2">Escalado de Atributos</h3>
                            <div id="weapon-detail-scales" class="grid grid-cols-2 sm:grid-cols-3 gap-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Pantalla de Equipamiento (oculta por defecto) -->
        <main id="screen-equipment" class="hidden">
            <header class="text-center mb-8">
                <h1 class="glass-title text-4xl font-bold mb-6">Equipamiento</h1>
                <div class="glass-card p-6 max-w-lg mx-auto glass-slide-in">
                    <div class="flex justify-between mb-3">
                        <span class="text-base font-semibold text-amber-400">Progreso de Equipamiento</span>
                        <span id="equipment-progress-text" class="text-sm font-semibold text-amber-400">0%</span>
                    </div>
                    <div class="glass-progress w-full h-3">
                        <div id="equipment-progress-bar" class="glass-progress-bar h-3" style="width: 0%"></div>
                    </div>
                </div>
            </header>

            <!-- Pestañas de navegación para equipamiento -->
            <nav class="glass-nav flex justify-center p-2 mb-8 max-w-6xl mx-auto glass-slide-in">
                <button data-equipment-tab="espadas" class="equipment-tab-button glass-nav-button active font-semibold text-amber-400 py-3 px-4 mx-1">Espadas <span id="espadas-total-count" class="text-xs ml-1"></span></button>
                <button data-equipment-tab="armas-pesadas" class="equipment-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-4 mx-1">Armas Pesadas <span id="armas-pesadas-total-count" class="text-xs ml-1"></span></button>
                <button data-equipment-tab="armas-distancia" class="equipment-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-4 mx-1">Distancia <span id="armas-distancia-total-count" class="text-xs ml-1"></span></button>
                <button data-equipment-tab="armas-magicas" class="equipment-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-4 mx-1">Mágicas <span id="armas-magicas-total-count" class="text-xs ml-1"></span></button>
                <button data-equipment-tab="armaduras" class="equipment-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-4 mx-1">Armaduras <span id="armaduras-total-count" class="text-xs ml-1"></span></button>
                <button data-equipment-tab="talismanes" class="equipment-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-4 mx-1">Talismanes <span id="talismanes-total-count" class="text-xs ml-1"></span></button>
            </nav>

            <!-- Contenido de las pestañas de equipamiento -->
            <div id="equipment-content-container">
                <div id="equipment-espadas" class="equipment-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Espadas -->
                </div>
                <div id="equipment-armas-pesadas" class="equipment-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Armas Pesadas -->
                </div>
                <div id="equipment-armas-distancia" class="equipment-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Armas de Distancia -->
                </div>
                <div id="equipment-armas-magicas" class="equipment-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Armas Mágicas -->
                </div>
                <div id="equipment-armaduras" class="equipment-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Armaduras -->
                </div>
                <div id="equipment-talismanes" class="equipment-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Talismanes -->
                </div>
            </div>
        </main>

        <!-- Pantalla de Objetos (oculta por defecto) -->
        <main id="screen-items" class="hidden">
            <header class="text-center mb-8">
                <h1 class="glass-title text-4xl font-bold mb-6">Objetos</h1>
                <div class="glass-card p-6 max-w-lg mx-auto glass-slide-in">
                    <div class="flex justify-between mb-3">
                        <span class="text-base font-semibold text-amber-400">Progreso de Objetos</span>
                        <span id="items-progress-text" class="text-sm font-semibold text-amber-400">0%</span>
                    </div>
                    <div class="glass-progress w-full h-3">
                        <div id="items-progress-bar" class="glass-progress-bar h-3" style="width: 0%"></div>
                    </div>
                </div>
            </header>

            <!-- Pestañas de navegación para objetos -->
            <nav class="glass-nav flex justify-center p-2 mb-8 max-w-4xl mx-auto glass-slide-in">
                <button data-items-tab="consumibles" class="items-tab-button glass-nav-button active font-semibold text-amber-400 py-3 px-6 mx-1">Consumibles <span id="consumibles-total-count" class="text-xs ml-1"></span></button>
                <button data-items-tab="materiales" class="items-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Materiales <span id="materiales-total-count" class="text-xs ml-1"></span></button>
                <button data-items-tab="claves" class="items-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Claves <span id="claves-total-count" class="text-xs ml-1"></span></button>
                <button data-items-tab="otros" class="items-tab-button glass-nav-button font-semibold text-zinc-400 py-3 px-6 mx-1">Otros <span id="otros-total-count" class="text-xs ml-1"></span></button>
            </nav>

            <!-- Contenido de las pestañas de objetos -->
            <div id="items-content-container">
                <div id="items-consumibles" class="items-content grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Consumibles -->
                </div>
                <div id="items-materiales" class="items-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Materiales -->
                </div>
                <div id="items-claves" class="items-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Claves -->
                </div>
                <div id="items-otros" class="items-content hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Contenido de Otros -->
                </div>
            </div>
        </main>
    </div>

    <!-- Navegación inferior fija -->
    <nav id="bottom-navigation" class="fixed bottom-0 left-0 right-0 z-50 glass-nav p-2">
        <div class="container mx-auto max-w-6xl">
            <div class="flex justify-around items-end">
                <button id="nav-zones" class="bottom-nav-button glass-nav-button active flex flex-col items-center py-2 px-4 text-amber-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span class="text-xs font-medium">Zonas</span>
                </button>
                <button id="nav-equipment" class="bottom-nav-button glass-nav-button flex flex-col items-center py-2 px-4 text-zinc-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                    <span class="text-xs font-medium">Equipamiento</span>
                </button>
                <button id="nav-items" class="bottom-nav-button glass-nav-button flex flex-col items-center py-2 px-4 text-zinc-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                    </svg>
                    <span class="text-xs font-medium">Objetos</span>
                </button>
                <button id="installButton-nav" class="bottom-nav-button glass-nav-button flex flex-col items-center py-2 px-4 text-zinc-400" style="display: none;">
                    <svg class="h-6 w-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                    <span class="text-xs font-medium">Instalar</span>
                </button>
            </div>
        </div>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // La API no tiene endpoint de misiones, las mantenemos localmente.
            const mockMissions = [
                { id: "mision01", name: "Misión de Ranni", description: "Ayuda a la bruja Ranni a desafiar a los Dos Dedos y forjar la Edad de las Estrellas.", location: "Liurnia of the Lakes" },
                { id: "mision02", name: "Misión de Fia", description: "Conviértete en el campeón de Fia, la Compañera de la Muerte, para dar a luz a la Runa de la Muerte.", location: "Deeproot Depths" },
                { id: "mision03", name: "Misión de Hyetta", description: "Guía a la doncella Hyetta hacia los Tres Dedos para que se convierta en la portadora de la Llama Frenética.", location: "Subterranean Shunning-Grounds" }
            ];

            // Elementos del DOM
            const screenZones = document.getElementById('screen-zones');
            const screenZoneDetail = document.getElementById('screen-zone-detail');
            const screenDetail = document.getElementById('screen-detail');
            const screenWeaponDetail = document.getElementById('screen-weapon-detail');
            const screenEquipment = document.getElementById('screen-equipment');
            const screenItems = document.getElementById('screen-items');
            const zoneListContainer = document.getElementById('zone-list');
            const zoneDetailTitle = document.getElementById('zone-detail-title');
            const loadingIndicator = document.getElementById('loading-indicator');
            const backButton = document.getElementById('back-button');
            const backToZonesButton = document.getElementById('back-to-zones-button');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Elementos de navegación inferior
            const navZones = document.getElementById('nav-zones');
            const navEquipment = document.getElementById('nav-equipment');
            const navItems = document.getElementById('nav-items');
            const bottomNavButtons = document.querySelectorAll('.bottom-nav-button');
            
            // Elementos de tabs de equipamiento
            const equipmentTabButtons = document.querySelectorAll('.equipment-tab-button');
            const equipmentContents = document.querySelectorAll('.equipment-content');
            
            // Elementos de tabs de objetos
            const itemsTabButtons = document.querySelectorAll('.items-tab-button');
            const itemsContents = document.querySelectorAll('.items-content');

            let gameData = { zones: {}, bosses: [], weapons: [], items: [], misiones: mockMissions };
            let progressState = {};
            const STORAGE_KEY = 'eldenRingProgress';
            let currentZoneId = null;

            // --- MANEJO DE ESTADO Y PROGRESO ---
            function loadProgress() {
                const savedProgress = localStorage.getItem(STORAGE_KEY);
                progressState = savedProgress ? JSON.parse(savedProgress) : {};
            }

            function saveProgress() {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(progressState));
            }

            // --- FUNCIONES DE RENDERIZADO Y UI ---

            function renderZones() {
                updateOverallProgressUI();

                try {
                    const zones = Object.values(gameData.zones);

                    // Obtener las dificultades de las regiones y convertirlas a valores numéricos
                    const difficultyValues = {
                        'Fácil': 1,
                        'Medio': 2,
                        'Difícil': 3,
                        'Muy Difícil': 4
                    };
                    
                    const regionDifficulties = {};
                    gameData.regionsDifficulty.forEach(region => {
                        regionDifficulties[region.name] = difficultyValues[region.difficulty] || 999;
                    });

                    // Ordenar las zonas por dificultad de menor a mayor
                    zones.sort((a, b) => {
                        const difficultyA = regionDifficulties[a.name] || 999;
                        const difficultyB = regionDifficulties[b.name] || 999;
                        return difficultyA - difficultyB;
                    });
                    if (!zones || zones.length === 0) throw new Error('No se encontraron datos de zonas en el mock.');
                    
                    loadingIndicator.style.display = 'none';
                    zoneListContainer.innerHTML = ''; // Limpiar la lista

                    zones.forEach(zone => {
                        const zoneProgress = calculateZoneProgress(zone.id);
                        const card = document.createElement('div');
                        card.className = 'glass-card p-6 cursor-pointer glass-slide-in';
                        card.dataset.id = zone.id;

                        card.innerHTML = `
                            <div class="flex justify-between items-center mb-3">
                                <h3 class="font-orbitron text-2xl font-bold text-white">${zone.name}</h3>
                                <span class="text-amber-400 font-semibold">${zoneProgress.toFixed(0)}%</span>
                            </div>
                            <p class="text-zinc-400 text-sm mt-2 mb-4 h-10">${zone.description || 'Una de las regiones de las Tierras Intermedias.'}</p>
                            <div class="glass-progress w-full h-3">
                                <div class="glass-progress-bar h-3" style="width: ${zoneProgress}%"></div>
                            </div>
                        `;
                        card.addEventListener('click', () => {
                            card.classList.add('glass-press');
                            setTimeout(() => card.classList.remove('glass-press'), 200);
                            showZoneDetail(zone.id);
                        });
                        zoneListContainer.appendChild(card);
                    });

                } catch (error) {
                    console.error(error);
                    // Mostramos un mensaje de error más descriptivo en la UI
                    loadingIndicator.innerHTML = `
                        <p class="text-red-400 font-semibold">Error al cargar las zonas.</p>
                        <p class="text-zinc-400 text-sm mt-2">${error.message}</p>`;
                }
            }

            function updateOverallProgressUI() {
                const overallProgress = calculateOverallProgress();
                const progressBar = document.getElementById('overall-progress-bar');
                const progressText = document.getElementById('overall-progress-text');
                if (progressBar) progressBar.style.width = `${overallProgress}%`;
                if (progressText) progressText.textContent = `${overallProgress.toFixed(0)}%`;
            }

            function handleCheckboxChange(e) {
                const itemId = e.target.dataset.id;
                const isChecked = e.target.checked;
                progressState[itemId] = isChecked;
                saveProgress();

                // Re-render la vista actual para actualizar barras de progreso
                if (currentZoneId) {
                    showZoneDetail(currentZoneId);
                }
            }

            function renderTabContent(zone, category) {
                const container = document.getElementById(`tab-${category}`);
                let itemIds = zone[category] || [];
                
                // Verificar si la categoría existe en gameData
                if (!gameData[category]) {
                    console.warn(`Categoría '${category}' no encontrada en gameData`);
                    container.innerHTML = `<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-zinc-400">Categoría '${category}' no disponible.</p></div>`;
                    return;
                }
                
                // Ordenar jefes por dificultad si es la categoría de jefes
                if (category === 'jefes') {
                    itemIds = sortBossesByDifficulty([...itemIds]);
                }
                
                const items = gameData[category].filter(item => itemIds.includes(item.id));

                container.innerHTML = ''; // Limpiar

                if (items.length === 0) {
                    container.innerHTML = `<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-zinc-400">No hay ${category} registrados en esta zona.</p></div>`;
                    return;
                }

                items.forEach((item, index) => {
                    let cardHtml = '';
                    const isChecked = progressState[item.id] || false;

                    if (category === 'jefes') {
                        const difficulty = calculateBossDifficulty(item);
                        const difficultyText = difficulty <= 2 ? 'Fácil' : difficulty <= 4 ? 'Medio' : difficulty <= 6 ? 'Difícil' : 'Muy Difícil';
                        const difficultyColor = difficulty <= 2 ? 'text-green-400' : difficulty <= 4 ? 'text-yellow-400' : difficulty <= 6 ? 'text-orange-400' : 'text-red-400';
                        
                        cardHtml = `
                            <label class="glass-card flex items-center p-4 cursor-pointer glass-slide-in">
                                <input type="checkbox" data-id="${item.id}" class="glass-checkbox progress-checkbox" ${isChecked ? 'checked' : ''}>
                                <div class="ml-4 flex-grow">
                                    <div class="flex items-center justify-between">
                                        <span class="text-white font-semibold ${isChecked ? 'line-through text-zinc-400' : ''}">${index + 1}. ${item.name}</span>
                                        <span class="text-xs ${difficultyColor} font-medium">${difficultyText}</span>
                                    </div>
                                    <div class="flex items-center mt-2 text-xs text-zinc-400">
                                        <span>${item.healthPoints || '???'} HP</span>
                                        ${item.drops && item.drops.find(drop => drop.includes('Runes')) ? 
                                            `<span class="ml-3">${item.drops.find(drop => drop.includes('Runes'))}</span>` : ''}
                                    </div>
                                </div>
                                <button data-boss-id="${item.id}" class="glass-button view-detail-btn text-xs text-amber-500 px-3 py-1 ml-2">Ver</button>
                            </label>
                        `;
                    } else {
                        cardHtml = `
                            <label class="glass-card flex items-start p-4 cursor-pointer glass-slide-in">
                                <input type="checkbox" data-id="${item.id}" class="glass-checkbox progress-checkbox mt-1" ${isChecked ? 'checked' : ''}>
                                <div class="ml-4">
                                    <span class="font-bold text-white ${isChecked ? 'line-through text-zinc-400' : ''}">${item.name}</span>
                                    <p class="text-zinc-400 text-sm mt-1">${item.description}</p>
                                </div>
                            </label>
                        `;
                    }
                    container.innerHTML += cardHtml;
                });

                container.querySelectorAll('.progress-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        // Animación de cristal
                        const card = e.target.closest('.glass-card');
                        if (card) {
                            card.classList.add('glass-press');
                            setTimeout(() => card.classList.remove('glass-press'), 200);
                        }
                        // Retroalimentación háptica
                        if (navigator.vibrate) {
                            navigator.vibrate(50);
                        }
                        handleCheckboxChange(e);
                    });
                });
                container.querySelectorAll('.view-detail-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault(); // Evita que el label active el checkbox
                        // Animación de cristal
                        button.classList.add('glass-press');
                        setTimeout(() => button.classList.remove('glass-press'), 200);
                        // Retroalimentación háptica
                        if (navigator.vibrate) {
                            navigator.vibrate(100);
                        }
                        showBossDetail(e.target.dataset.bossId, zone.id);
                    });
                });
            }

            function showZoneDetail(zoneId) {
                currentZoneId = zoneId;

                // Ocultar todas las pantallas excepto la de detalle de zona
                document.querySelectorAll('main').forEach(screen => {
                    screen.classList.add('hidden');
                });
                screenZoneDetail.classList.remove('hidden');

                const zone = gameData.zones[zoneId];
                if (!zone) {
                    zoneDetailTitle.textContent = 'Zona no encontrada';
                    return;
                }

                zoneDetailTitle.textContent = zone.name;

                // Renderizar contenido para todas las pestañas
                renderTabContent(zone, 'jefes');
                renderTabContent(zone, 'misiones');
                renderTabContent(zone, 'armas');
                renderTabContent(zone, 'objetos');
                
                // Agregar indicador de ordenamiento por dificultad en la pestaña de jefes
                const jefesTab = document.getElementById('tab-jefes');
                if (jefesTab && zone.jefes && zone.jefes.length > 0) {
                    const orderIndicator = document.createElement('div');
                    orderIndicator.className = 'glass-card text-xs text-zinc-500 text-center mb-4 p-3 glass-fade-in';
                    orderIndicator.innerHTML = '🗡️ Jefes ordenados por dificultad (más fácil → más difícil)';
                    jefesTab.insertBefore(orderIndicator, jefesTab.firstChild);
                }

                // Actualizar porcentajes de las pestañas
                ['jefes', 'misiones', 'armas', 'objetos'].forEach(category => {
                    const progress = calculateProgress(zone[category] || []);
                    const textElement = document.getElementById(`${category}-progress-text`);
                    if (textElement) {
                        textElement.textContent = `(${progress.toFixed(0)}%)`;
                    }
                });

                // Activar la primera pestaña por defecto
                tabButtons.forEach(btn => {
                    if (btn.dataset.tab === 'jefes') {
                        btn.classList.add('text-amber-400', 'active');
                        btn.classList.remove('text-zinc-400');
                    } else {
                        btn.classList.remove('text-amber-400', 'active');
                        btn.classList.add('text-zinc-400');
                    }
                });
                tabContents.forEach(content => {
                    if (content.id === 'tab-jefes') {
                        content.classList.remove('hidden');
                        content.classList.add('glass-fade-in');
                    } else {
                        content.classList.add('hidden');
                    }
                });

                window.scrollTo(0, 0);
            }

            // --- FUNCIONES DE CÁLCULO ---
            
            // Función para calcular la dificultad de un jefe
            function calculateBossDifficulty(boss) {
                let difficulty = 0;
                
                // Basado en puntos de vida
                if (boss.healthPoints) {
                    const health = parseInt(boss.healthPoints.replace(/[^\d]/g, '')) || 0;
                    if (health > 0) {
                        if (health < 5000) difficulty += 1;
                        else if (health < 15000) difficulty += 2;
                        else if (health < 50000) difficulty += 3;
                        else difficulty += 4;
                    }
                }
                
                // Basado en runas (recompensa)
                if (boss.drops) {
                    const runes = boss.drops.find(drop => drop.includes('Runes'));
                    if (runes) {
                        const runeAmount = parseInt(runes.replace(/[^\d]/g, '')) || 0;
                        if (runeAmount > 100000) difficulty += 3;
                        else if (runeAmount > 50000) difficulty += 2;
                        else if (runeAmount > 10000) difficulty += 1;
                    }
                }
                
                // Jefes especiales conocidos por su dificultad
                const hardBosses = ['malenia', 'elden beast', 'radagon', 'maliketh', 'radahn'];
                if (hardBosses.some(hardBoss => boss.name.toLowerCase().includes(hardBoss))) {
                    difficulty += 2;
                }
                
                return difficulty;
            }
            
            // Función para ordenar jefes por dificultad
            function sortBossesByDifficulty(bossIds) {
                return bossIds.sort((a, b) => {
                    const bossA = gameData.bosses.find(boss => boss.id === a);
                    const bossB = gameData.bosses.find(boss => boss.id === b);
                    
                    if (!bossA || !bossB) return 0;
                    
                    const difficultyA = calculateBossDifficulty(bossA);
                    const difficultyB = calculateBossDifficulty(bossB);
                    
                    return difficultyA - difficultyB; // Orden ascendente (más fácil primero)
                });
            }
            
            function calculateProgress(itemIds) {
                if (!itemIds || itemIds.length === 0) return 100;
                const completedItems = itemIds.filter(id => progressState[id]).length;
                return (completedItems / itemIds.length) * 100;
            }

            function calculateZoneProgress(zoneId) {
                const zone = gameData.zones[zoneId];
                if (!zone) return 0;
                const bossProgress = calculateProgress(zone.jefes || []);
                const missionProgress = calculateProgress(zone.misiones || []);
                return (bossProgress + missionProgress) / 2;
            }

            function calculateOverallProgress() {
                const zoneIds = Object.keys(gameData.zones);
                if (zoneIds.length === 0) return 0;
                const totalProgress = zoneIds.reduce((sum, zoneId) => sum + calculateZoneProgress(zoneId), 0);
                return totalProgress / zoneIds.length;
            }

            function showBossDetail(bossId, fromZoneId) {
                // Ocultar todas las pantallas excepto la de detalle de jefe
                document.querySelectorAll('main').forEach(screen => {
                    screen.classList.add('hidden');
                });
                screenDetail.classList.remove('hidden');
                document.getElementById('detail-content').classList.add('hidden');

                try {
                    const boss = gameData.bosses.find(b => b.id === bossId);
                    if (!boss) throw new Error('No se pudo encontrar el detalle del jefe.');

                    // Guardar el contexto de la zona para el botón de regreso
                    backButton.dataset.fromZone = fromZoneId;

                    // Rellenar los detalles
                    document.getElementById('detail-image').src = boss.image || 'https://via.placeholder.com/400x225.png?text=No+Image';
                    document.getElementById('detail-name').textContent = boss.name;
                    document.getElementById('detail-description').textContent = boss.description || 'No hay descripción disponible.';
                    document.getElementById('detail-location').textContent = boss.location || 'Desconocida';
                    document.getElementById('detail-health').textContent = boss.healthPoints || 'No disponible';
                    document.getElementById('detail-runes').textContent = boss.runes ? new Intl.NumberFormat().format(boss.runes) : 'No disponible';
                    
                    const dropsList = document.getElementById('detail-drops');
                    dropsList.innerHTML = '';

                    if (boss.drops && boss.drops.length > 0) {
                        boss.drops.forEach(drop => {
                            const li = document.createElement('li');
                            li.textContent = drop;
                            dropsList.appendChild(li);
                        });
                    } else {
                        dropsList.innerHTML = '<li>No se conocen recompensas.</li>';
                    }

                    const weaknessesList = document.getElementById('detail-weaknesses');
                    weaknessesList.innerHTML = '';
                    if (boss.weaknesses && boss.weaknesses.length > 0) {
                        boss.weaknesses.forEach(weakness => {
                            const li = document.createElement('li');
                            li.textContent = weakness;
                            weaknessesList.appendChild(li);
                        });
                    } else {
                        weaknessesList.innerHTML = '<li>Ninguna conocida.</li>';
                    }

                    const strengthsList = document.getElementById('detail-strengths');
                    strengthsList.innerHTML = '';
                    if (boss.strengths && boss.strengths.length > 0) {
                        boss.strengths.forEach(strength => {
                            const li = document.createElement('li');
                            li.textContent = strength;
                            strengthsList.appendChild(li);
                        });
                    } else {
                        strengthsList.innerHTML = '<li>Ninguna conocida.</li>';
                    }

                    document.getElementById('detail-content').classList.remove('hidden'); // Mostrar contenido
                    document.getElementById('detail-content').classList.add('glass-fade-in'); // Agregar animación
                    window.scrollTo(0, 0); // Ir al inicio de la página

                } catch (error) {
                    // Si falla la carga del detalle, mostramos un error claro
                    document.getElementById('detail-name').textContent = 'Error al cargar';
                    document.getElementById('detail-description').textContent = `No se pudo obtener el detalle de este jefe. ${error.message}`;
                    console.error(error);
                }
            }

            function showWeaponDetail(weaponId) {
                document.querySelectorAll('main').forEach(screen => {
                    screen.classList.add('hidden');
                });
                const weaponDetailScreen = document.getElementById('screen-weapon-detail');
                weaponDetailScreen.classList.remove('hidden');
                document.getElementById('weapon-detail-content').classList.add('hidden');

                try {
                    const weapon = gameData.weapons.find(w => w.id === weaponId);
                    if (!weapon) throw new Error('No se pudo encontrar el detalle del arma.');

                    document.getElementById('weapon-detail-image').src = weapon.image || 'https://via.placeholder.com/400x225.png?text=No+Image';
                    document.getElementById('weapon-detail-name').textContent = weapon.name;
                    document.getElementById('weapon-detail-description').textContent = weapon.description || 'No hay descripción disponible.';
                    document.getElementById('weapon-detail-location').textContent = weapon.location || 'Desconocida';
                    document.getElementById('weapon-detail-category').textContent = weapon.category || 'N/A';
                    document.getElementById('weapon-detail-weight').textContent = weapon.weight || 'N/A';

                    const attackContainer = document.getElementById('weapon-detail-attack');
                    attackContainer.innerHTML = '';
                    if (weapon.attack && weapon.attack.length > 0) {
                        weapon.attack.forEach(stat => {
                            attackContainer.innerHTML += `<div class="flex justify-between"><span>${stat.name}:</span><span>${stat.amount}</span></div>`;
                        });
                    }

                    const defenceContainer = document.getElementById('weapon-detail-defence');
                    defenceContainer.innerHTML = '';
                    if (weapon.defence && weapon.defence.length > 0) {
                        weapon.defence.forEach(stat => {
                            defenceContainer.innerHTML += `<div class="flex justify-between"><span>${stat.name}:</span><span>${stat.amount}</span></div>`;
                        });
                    }

                    const requiredContainer = document.getElementById('weapon-detail-required');
                    requiredContainer.innerHTML = '';
                    if (weapon.requiredAttributes && weapon.requiredAttributes.length > 0) {
                        weapon.requiredAttributes.forEach(stat => {
                            requiredContainer.innerHTML += `<div class="flex justify-between"><span>${stat.name}:</span><span>${stat.amount}</span></div>`;
                        });
                    }

                    const scalesContainer = document.getElementById('weapon-detail-scales');
                    scalesContainer.innerHTML = '';
                    if (weapon.scalesWith && weapon.scalesWith.length > 0) {
                        weapon.scalesWith.forEach(stat => {
                            scalesContainer.innerHTML += `<div class="flex justify-between"><span>${stat.name}:</span><span>${stat.scaling}</span></div>`;
                        });
                    }

                    document.getElementById('weapon-detail-content').classList.remove('hidden');
                    document.getElementById('weapon-detail-content').classList.add('glass-fade-in');
                    window.scrollTo(0, 0);

                } catch (error) {
                    document.getElementById('weapon-detail-name').textContent = 'Error al cargar';
                    document.getElementById('weapon-detail-description').textContent = `No se pudo obtener el detalle de esta arma. ${error.message}`;
                    console.error(error);
                }
            }

            function processApiData() {
                // Primero, inicializamos las zonas a partir de las regiones únicas en locations.json
                gameData.zones = {}; // Limpiar zonas existentes
                const uniqueRegions = new Set();

                gameData.locations.forEach(location => {
                    if (location.region && !uniqueRegions.has(location.region)) {
                        const zoneName = location.region.trim();
                        const zoneId = zoneName.toLowerCase().replace(/\s+/g, '-');
                        gameData.zones[zoneId] = {
                            id: zoneId,
                            name: zoneName,
                            description: `Explora la región de ${zoneName}.`,
                            jefes: [],
                            misiones: [],
                            armas: [],
                            objetos: []
                        };
                        uniqueRegions.add(location.region);
                    }
                });

                // Mapeo automático de jefes a regiones basado en los datos reales (español)
                console.log('Zonas disponibles:', Object.keys(gameData.zones));
                let limgraveBosses = 0;
                
                gameData.bosses.forEach(boss => {
                    if (!boss.region) return;
                    
                    // Convertir el nombre de la región a un ID de zona
                    let regionId = null;
                    const regionName = boss.region.toLowerCase();
                    
                    if (regionName.includes('limgrave')) {
                        regionId = 'limgrave';
                        limgraveBosses++;
                        console.log(`Jefe de Limgrave encontrado: ${boss.name} (${boss.region})`);
                    } else if (regionName.includes('península llorona')) {
                        regionId = 'weeping-peninsula';
                    } else if (regionName.includes('liurnia de los lagos') || regionName.includes('liurnia')) {
                        regionId = 'liurnia-of-the-lakes';
                    } else if (regionName.includes('caelid')) {
                        regionId = 'caelid';
                    } else if (regionName.includes('meseta de altus') || regionName.includes('altus')) {
                        regionId = 'altus-pleateau';
                    } else if (regionName.includes('cumbres de los gigantes') || regionName.includes('campo de nieve consagrado') || regionName.includes('haligtree')) {
                        regionId = 'mountaintops-of-the-giants';
                    } else if (regionName.includes('monte gelmir') || regionName.includes('gelmir')) {
                        regionId = 'mount-gelmir';
                    } else if (regionName.includes('profundidades de raíz profunda') || regionName.includes('mohgwyn')) {
                        regionId = 'deeproot-depths';
                    } else if (regionName.includes('farum azula en ruinas') || regionName.includes('farum azula')) {
                        regionId = 'crumbling-farum-azula';
                    }

                    if (regionId && gameData.zones[regionId]) {
                        if (!gameData.zones[regionId].jefes.includes(boss.id)) {
                            gameData.zones[regionId].jefes.push(boss.id);
                        }
                    } else if (regionId) {
                        console.log(`Zona no encontrada para regionId: ${regionId}, boss: ${boss.name}`);
                    }
                });
                
                console.log(`Total jefes de Limgrave procesados: ${limgraveBosses}`);
                console.log(`Jefes asignados a Limgrave: ${gameData.zones['limgrave']?.jefes?.length || 0}`);

                // Asignar objetos a sus regiones
                gameData.items.forEach(item => {
                    if (!item.location) return;
                    
                    // Mapeo manual de ubicaciones a regiones
                    let regionId = null;
                    if (item.location.includes('Limgrave') || item.location.includes('Stormhill') || item.location.includes('Stormveil')) {
                        regionId = 'limgrave';
                    } else if (item.location.includes('Weeping Peninsula') || item.location.includes('Castle Morne')) {
                        regionId = 'weeping-peninsula';
                    } else if (item.location.includes('Liurnia') || item.location.includes('Raya Lucaria')) {
                        regionId = 'liurnia-of-the-lakes';
                    } else if (item.location.includes('Caelid')) {
                        regionId = 'caelid';
                    } else if (item.location.includes('Altus Plateau') || item.location.includes('Leyndell')) {
                        regionId = 'altus-pleateau';
                    } else if (item.location.includes('Mountaintops') || item.location.includes('Haligtree')) {
                        regionId = 'mountaintops-of-the-giants';
                    }

                    if (regionId && gameData.zones[regionId]) {
                        if (!gameData.zones[regionId].objetos.includes(item.id)) {
                            gameData.zones[regionId].objetos.push(item.id);
                        }
                    }
                });

                // Asignar armas a regiones (ejemplo básico)
                gameData.weapons.forEach(weapon => {
                    if (!weapon.location) return;
                    
                    let regionId = null;
                    if (weapon.location.includes('Limgrave') || weapon.location.includes('Stormveil')) {
                        regionId = 'limgrave';
                    } else if (weapon.location.includes('Liurnia') || weapon.location.includes('Raya Lucaria')) {
                        regionId = 'liurnia-of-the-lakes';
                    } else if (weapon.location.includes('Caelid')) {
                        regionId = 'caelid';
                    }

                    if (regionId && gameData.zones[regionId]) {
                        if (!gameData.zones[regionId].armas.includes(weapon.id)) {
                            gameData.zones[regionId].armas.push(weapon.id);
                        }
                    }
                });

                // Asignar misiones a regiones basándose en la propiedad region del archivo
                if (gameData.misiones && gameData.misiones.length > 0) {
                    gameData.misiones.forEach(mision => {
                        if (mision.region && gameData.zones[mision.region]) {
                            if (!gameData.zones[mision.region].misiones.includes(mision.id)) {
                                gameData.zones[mision.region].misiones.push(mision.id);
                            }
                        }
                    });
                }

                console.log('Zonas procesadas:', Object.keys(gameData.zones));
                console.log('Jefes por zona:', Object.values(gameData.zones).map(zone => ({
                    name: zone.name,
                    jefes: zone.jefes.length,
                    objetos: zone.objetos.length,
                    armas: zone.armas.length,
                    misiones: zone.misiones.length
                })));
            }

            async function initializeApp() {
                try {
                    loadingIndicator.textContent = 'Cargando archivos de datos...';

                    const [bossesRes, weaponsRes, itemsRes, locationsRes, regionsDifficultyRes, missionsRes, armorsRes, shieldsRes, talismansRes] = await Promise.all([
                        fetch('./data/bosses_es.json'),
                        fetch('./data/weapons_es.json'),
                        fetch('./data/items_es.json'),
                        fetch('./data/locations_es.json'),
                        fetch('./data/regions_difficulty_es.json'),
                        fetch('./data/missions_es.json'),
                        fetch('./data/armors.json').catch(() => null),
                        fetch('./data/shields.json').catch(() => null),
                        fetch('./data/talismans.json').catch(() => null)
                    ]);

                    // Los archivos JSON son arrays directamente, no necesitan .data
                    gameData.bosses = await bossesRes.json();
                    gameData.weapons = await weaponsRes.json();
                    gameData.items = await itemsRes.json();
                    gameData.locations = await locationsRes.json();
                    gameData.regionsDifficulty = await regionsDifficultyRes.json();
                    gameData.misiones = await missionsRes.json();
                    
                    // Cargar datos adicionales si están disponibles
                    if (armorsRes) {
                        gameData.armors = await armorsRes.json();
                    } else {
                        gameData.armors = [];
                    }
                    
                    if (shieldsRes) {
                        gameData.shields = await shieldsRes.json();
                    } else {
                        gameData.shields = [];
                    }
                    
                    if (talismansRes) {
                        gameData.talismans = await talismansRes.json();
                    } else {
                        gameData.talismans = [];
                    }
                    
                    // Inicializar categorías que pueden no existir
                    if (!gameData.armas) gameData.armas = [];
                    if (!gameData.objetos) gameData.objetos = [];
                    
                    // Crear alias para compatibilidad con nombres en español
                    gameData.jefes = gameData.bosses;
                    gameData.armas = gameData.weapons;
                    gameData.objetos = gameData.items;

                    processApiData();
                    console.log("Unique Regions:", Object.values(gameData.zones).map(zone => zone.name));
                    loadProgress();
                    renderZones();
                } catch (error) {
                    loadingIndicator.innerHTML = `<p class="text-red-400 font-semibold">Error al cargar los archivos de datos. Asegúrate de que la carpeta /data y los archivos JSON existen.</p><p class="text-zinc-400 text-sm mt-2">${error.message}</p>`;
                }
            }

            // --- FUNCIONES DE NAVEGACIÓN PRINCIPAL ---
            function showScreen(screenId) {
                // Ocultar todas las pantallas
                document.querySelectorAll('main').forEach(screen => {
                    screen.classList.add('hidden');
                });
                
                // Mostrar la pantalla seleccionada
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.remove('hidden');
                    targetScreen.classList.add('glass-fade-in');
                }
                
                // Actualizar navegación inferior
                bottomNavButtons.forEach(btn => {
                    btn.classList.remove('active', 'text-amber-400');
                    btn.classList.add('text-zinc-400');
                });
                
                // Activar el botón correspondiente
                if (screenId === 'screen-zones') {
                    navZones.classList.add('active', 'text-amber-400');
                    navZones.classList.remove('text-zinc-400');
                } else if (screenId === 'screen-equipment') {
                    navEquipment.classList.add('active', 'text-amber-400');
                    navEquipment.classList.remove('text-zinc-400');
                } else if (screenId === 'screen-items') {
                    navItems.classList.add('active', 'text-amber-400');
                    navItems.classList.remove('text-zinc-400');
                }
                
                window.scrollTo(0, 0);
            }

            function renderEquipmentContent() {
                // Categorizar armas
                const espadas = gameData.weapons.filter(weapon => 
                    ['Straight Sword', 'Curved Sword', 'Thrusting Sword', 'Heavy Thrusting Sword', 'Katana', 'Dagger'].includes(weapon.category)
                );
                const armasPesadas = gameData.weapons.filter(weapon => 
                    ['Greatsword', 'Curved Greatsword', 'Colossal Sword', 'Colossal Weapon', 'Greataxe', 'Great Spear', 'Halberd', 'Hammer', 'Warhammer', 'Flail', 'Whip'].includes(weapon.category)
                );
                const armasDistancia = gameData.weapons.filter(weapon => 
                    ['Bow', 'Light Bow', 'Greatbow', 'Crossbow', 'Ballista'].includes(weapon.category)
                );
                const armasMagicas = gameData.weapons.filter(weapon => 
                    ['Glintstone Staff', 'Sacred Seal', 'Torch'].includes(weapon.category)
                );
                const armasEspeciales = gameData.weapons.filter(weapon => 
                    ['Claw', 'Fist', 'Reaper', 'Twinblade'].includes(weapon.category)
                );
                
                // Renderizar cada categoría
                renderEquipmentTab('espadas', espadas);
                renderEquipmentTab('armas-pesadas', armasPesadas);
                renderEquipmentTab('armas-distancia', armasDistancia);
                renderEquipmentTab('armas-magicas', [...armasMagicas, ...armasEspeciales]);
                
                // Renderizar armaduras (si tenemos datos)
                renderEquipmentTab('armaduras', gameData.armors || []);
                
                // Renderizar talismanes (si tenemos datos)
                renderEquipmentTab('talismanes', gameData.talismans || []);
                
                // Actualizar contadores
                updateEquipmentCounters();
            }

            function renderEquipmentTab(category, items) {
                const container = document.getElementById(`equipment-${category}`);
                if (!container) return;
                
                container.innerHTML = '';
                
                if (items.length === 0) {
                    container.innerHTML = `<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-zinc-400">No hay ${category} disponibles.</p></div>`;
                    return;
                }
                
                // Mostrar indicador de carga
                container.innerHTML = '<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-amber-400">Cargando...</p></div>';
                
                // Usar requestAnimationFrame para cargar de forma asíncrona
                requestAnimationFrame(() => {
                    let html = '';
                    const batchSize = 20; // Cargar de 20 en 20
                    let currentIndex = 0;
                    
                    function renderBatch() {
                        const endIndex = Math.min(currentIndex + batchSize, items.length);
                        
                        for (let i = currentIndex; i < endIndex; i++) {
                            const item = items[i];
                            const isChecked = progressState[item.id] || false;
                            html += `
                                <label class="glass-card flex items-center p-4 cursor-pointer glass-slide-in">
                                    <input type="checkbox" data-id="${item.id}" class="glass-checkbox progress-checkbox" ${isChecked ? 'checked' : ''}>
                                    <div class="ml-4 flex-grow">
                                        <span class="font-bold text-white ${isChecked ? 'line-through text-zinc-400' : ''}">${item.name}</span>
                                        <p class="text-zinc-400 text-sm mt-1">${item.category || ''}</p>
                                    </div>
                                    <button data-weapon-id="${item.id}" class="glass-button view-weapon-detail-btn text-xs text-amber-500 px-3 py-1 ml-2">Ver</button>
                                </label>
                            `;
                        }
                        
                        container.innerHTML = html;
                        
                        // Agregar event listeners a los checkboxes
                        container.querySelectorAll('.progress-checkbox').forEach(checkbox => {
                            checkbox.addEventListener('change', (e) => {
                                const card = e.target.closest('.glass-card');
                                if (card) {
                                    card.classList.add('glass-press');
                                    setTimeout(() => card.classList.remove('glass-press'), 200);
                                }
                                if (navigator.vibrate) {
                                    navigator.vibrate(50);
                                }
                                handleCheckboxChange(e);
                            });
                        });

                        container.querySelectorAll('.view-weapon-detail-btn').forEach(button => {
                            button.addEventListener('click', (e) => {
                                e.preventDefault();
                                button.classList.add('glass-press');
                                setTimeout(() => button.classList.remove('glass-press'), 200);
                                if (navigator.vibrate) {
                                    navigator.vibrate(100);
                                }
                                showWeaponDetail(e.target.dataset.weaponId);
                            });
                        });
                        
                        currentIndex = endIndex;
                        
                        // Si hay más elementos, continuar con el siguiente lote
                        if (currentIndex < items.length) {
                            requestAnimationFrame(renderBatch);
                        }
                    }
                    
                    renderBatch();
                });
            }

            function renderItemsContent() {
                // Categorizar objetos
                const consumibles = gameData.items.filter(item => 
                    item.type && (item.type.includes('consumible') || item.type.includes('poción') || item.type.includes('comida'))
                );
                const materiales = gameData.items.filter(item => 
                    item.type && (item.type.includes('material') || item.type.includes('crafting') || item.type.includes('upgrade'))
                );
                const claves = gameData.items.filter(item => 
                    item.type && (item.type.includes('key') || item.type.includes('clave') || item.type.includes('llave'))
                );
                const otros = gameData.items.filter(item => 
                    !consumibles.includes(item) && !materiales.includes(item) && !claves.includes(item)
                );
                
                // Renderizar cada categoría
                renderItemsTab('consumibles', consumibles);
                renderItemsTab('materiales', materiales);
                renderItemsTab('claves', claves);
                renderItemsTab('otros', otros);
                
                // Actualizar contadores
                updateItemsCounters();
            }

            function renderItemsTab(category, items) {
                const container = document.getElementById(`items-${category}`);
                if (!container) return;
                
                container.innerHTML = '';
                
                if (items.length === 0) {
                    container.innerHTML = `<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-zinc-400">No hay ${category} disponibles.</p></div>`;
                    return;
                }
                
                // Mostrar indicador de carga
                container.innerHTML = '<div class="glass-card col-span-full text-center p-6 glass-fade-in"><p class="text-amber-400">Cargando...</p></div>';
                
                // Usar requestAnimationFrame para cargar de forma asíncrona
                requestAnimationFrame(() => {
                    let html = '';
                    const batchSize = 20; // Cargar de 20 en 20
                    let currentIndex = 0;
                    
                    function renderBatch() {
                        const endIndex = Math.min(currentIndex + batchSize, items.length);
                        
                        for (let i = currentIndex; i < endIndex; i++) {
                            const item = items[i];
                            const isChecked = progressState[item.id] || false;
                            html += `
                                <label class="glass-card flex items-start p-4 cursor-pointer glass-slide-in">
                                    <input type="checkbox" data-id="${item.id}" class="glass-checkbox progress-checkbox mt-1" ${isChecked ? 'checked' : ''}>
                                    <div class="ml-4">
                                        <span class="font-bold text-white ${isChecked ? 'line-through text-zinc-400' : ''}">${item.name}</span>
                                        <p class="text-zinc-400 text-sm mt-1">${item.description || 'Sin descripción disponible.'}</p>
                                        ${item.location ? `<p class="text-zinc-500 text-xs mt-2">📍 ${item.location}</p>` : ''}
                                    </div>
                                </label>
                            `;
                        }
                        
                        container.innerHTML = html;
                        
                        // Agregar event listeners a los checkboxes
                        container.querySelectorAll('.progress-checkbox').forEach(checkbox => {
                            checkbox.addEventListener('change', (e) => {
                                const card = e.target.closest('.glass-card');
                                if (card) {
                                    card.classList.add('glass-press');
                                    setTimeout(() => card.classList.remove('glass-press'), 200);
                                }
                                if (navigator.vibrate) {
                                    navigator.vibrate(50);
                                }
                                handleCheckboxChange(e);
                            });
                        });
                        
                        currentIndex = endIndex;
                        
                        // Si hay más elementos, continuar con el siguiente lote
                        if (currentIndex < items.length) {
                            requestAnimationFrame(renderBatch);
                        }
                    }
                    
                    renderBatch();
                });
            }

            function updateEquipmentCounters() {
                // Calcular contadores para cada categoría de armas
                const espadas = gameData.weapons.filter(weapon => 
                    ['Straight Sword', 'Curved Sword', 'Thrusting Sword', 'Heavy Thrusting Sword', 'Katana', 'Dagger'].includes(weapon.category)
                ).length;
                const armasPesadas = gameData.weapons.filter(weapon => 
                    ['Greatsword', 'Curved Greatsword', 'Colossal Sword', 'Colossal Weapon', 'Greataxe', 'Great Spear', 'Halberd', 'Hammer', 'Warhammer', 'Flail', 'Whip'].includes(weapon.category)
                ).length;
                const armasDistancia = gameData.weapons.filter(weapon => 
                    ['Bow', 'Light Bow', 'Greatbow', 'Crossbow', 'Ballista'].includes(weapon.category)
                ).length;
                const armasMagicas = gameData.weapons.filter(weapon => 
                    ['Glintstone Staff', 'Sacred Seal', 'Torch', 'Claw', 'Fist', 'Reaper', 'Twinblade'].includes(weapon.category)
                ).length;
                
                const counters = {
                    'espadas': espadas,
                    'armas-pesadas': armasPesadas,
                    'armas-distancia': armasDistancia,
                    'armas-magicas': armasMagicas,
                    'armaduras': (gameData.armors || []).length,
                    'talismanes': (gameData.talismans || []).length
                };
                
                Object.entries(counters).forEach(([category, count]) => {
                    const counterElement = document.getElementById(`${category}-total-count`);
                    if (counterElement) {
                        counterElement.textContent = `(${count})`;
                    }
                });
            }

            function updateItemsCounters() {
                const consumibles = gameData.items.filter(item => 
                    item.type && (item.type.includes('consumible') || item.type.includes('poción') || item.type.includes('comida'))
                ).length;
                const materiales = gameData.items.filter(item => 
                    item.type && (item.type.includes('material') || item.type.includes('crafting') || item.type.includes('upgrade'))
                ).length;
                const claves = gameData.items.filter(item => 
                    item.type && (item.type.includes('key') || item.type.includes('clave') || item.type.includes('llave'))
                ).length;
                const otros = gameData.items.length - consumibles - materiales - claves;
                
                const counters = {
                    'consumibles': consumibles,
                    'materiales': materiales,
                    'claves': claves,
                    'otros': otros
                };
                
                Object.entries(counters).forEach(([category, count]) => {
                    const counterElement = document.getElementById(`${category}-total-count`);
                    if (counterElement) {
                        counterElement.textContent = `(${count})`;
                    }
                });
            }

            // --- NAVEGACIÓN ---
            backButton.addEventListener('click', () => {
                // Animación de cristal
                backButton.classList.add('glass-press');
                setTimeout(() => backButton.classList.remove('glass-press'), 200);
                // Retroalimentación háptica
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                const fromZone = backButton.dataset.fromZone;
                if (fromZone) {
                    showZoneDetail(fromZone);
                }
            });

            const backToEquipmentButton = document.getElementById('back-to-equipment-button');
            backToEquipmentButton.addEventListener('click', () => {
                backToEquipmentButton.classList.add('glass-press');
                setTimeout(() => backToEquipmentButton.classList.remove('glass-press'), 200);
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                showScreen('screen-equipment');
            });

            backToZonesButton.addEventListener('click', () => {
                // Animación de cristal
                backToZonesButton.classList.add('glass-press');
                setTimeout(() => backToZonesButton.classList.remove('glass-press'), 200);
                // Retroalimentación háptica
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                screenZoneDetail.classList.add('hidden');
                currentZoneId = null;
                renderZones(); // Re-render para mostrar progreso actualizado
                screenZones.classList.remove('hidden');
            });

            // --- NAVEGACIÓN INFERIOR ---
            navZones.addEventListener('click', () => {
                navZones.classList.add('glass-press');
                setTimeout(() => navZones.classList.remove('glass-press'), 200);
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                showScreen('screen-zones');
            });

            navEquipment.addEventListener('click', () => {
                navEquipment.classList.add('glass-press');
                setTimeout(() => navEquipment.classList.remove('glass-press'), 200);
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                showScreen('screen-equipment');
                renderEquipmentContent();
            });

            navItems.addEventListener('click', () => {
                navItems.classList.add('glass-press');
                setTimeout(() => navItems.classList.remove('glass-press'), 200);
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
                showScreen('screen-items');
                renderItemsContent();
            });

            // --- TABS DE EQUIPAMIENTO ---
            equipmentTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    button.classList.add('glass-press');
                    setTimeout(() => button.classList.remove('glass-press'), 200);
                    if (navigator.vibrate) {
                        navigator.vibrate(30);
                    }
                    
                    const tabId = button.dataset.equipmentTab;

                    // Actualizar botones
                    equipmentTabButtons.forEach(btn => {
                        btn.classList.remove('text-amber-400', 'active');
                        btn.classList.add('text-zinc-400');
                    });
                    button.classList.add('text-amber-400', 'active');
                    button.classList.remove('text-zinc-400');

                    // Actualizar contenido
                    equipmentContents.forEach(content => {
                        content.classList.toggle('hidden', content.id !== `equipment-${tabId}`);
                        if (content.id === `equipment-${tabId}`) {
                            content.classList.add('glass-fade-in');
                        }
                    });
                });
            });

            // --- TABS DE OBJETOS ---
            itemsTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    button.classList.add('glass-press');
                    setTimeout(() => button.classList.remove('glass-press'), 200);
                    if (navigator.vibrate) {
                        navigator.vibrate(30);
                    }
                    
                    const tabId = button.dataset.itemsTab;

                    // Actualizar botones
                    itemsTabButtons.forEach(btn => {
                        btn.classList.remove('text-amber-400', 'active');
                        btn.classList.add('text-zinc-400');
                    });
                    button.classList.add('text-amber-400', 'active');
                    button.classList.remove('text-zinc-400');

                    // Actualizar contenido
                    itemsContents.forEach(content => {
                        content.classList.toggle('hidden', content.id !== `items-${tabId}`);
                        if (content.id === `items-${tabId}`) {
                            content.classList.add('glass-fade-in');
                        }
                    });
                });
            });

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Animación de cristal
                    button.classList.add('glass-press');
                    setTimeout(() => button.classList.remove('glass-press'), 200);
                    // Retroalimentación háptica
                    if (navigator.vibrate) {
                        navigator.vibrate(30);
                    }
                    
                    const tabId = button.dataset.tab;

                    tabButtons.forEach(btn => {
                        btn.classList.remove('text-amber-400', 'active');
                        btn.classList.add('text-zinc-400');
                    });
                    button.classList.add('text-amber-400', 'active');
                    button.classList.remove('text-zinc-400');

                    tabContents.forEach(content => {
                        content.classList.toggle('hidden', content.id !== `tab-${tabId}`);
                        if (content.id === `tab-${tabId}`) {
                            content.classList.add('glass-fade-in');
                        }
                    });
                });
            });

            // --- EFECTO PARALLAX ---
            function initParallax() {
                let ticking = false;
                
                function updateParallax() {
                    const scrolled = window.pageYOffset;
                    const parallaxElements = document.querySelectorAll('.parallax-bg');
                    
                    parallaxElements.forEach(element => {
                        const speed = 0.5;
                        element.style.transform = `translateY(${scrolled * speed}px)`;
                    });
                    
                    ticking = false;
                }
                
                function requestTick() {
                    if (!ticking) {
                        requestAnimationFrame(updateParallax);
                        ticking = true;
                    }
                }
                
                window.addEventListener('scroll', requestTick);
            }

            // --- TRANSICIONES DE PANTALLA ---
            function addScreenTransitions() {
                const screens = document.querySelectorAll('main');
                
                screens.forEach(screen => {
                    screen.style.transition = 'opacity 0.4s ease-in-out, transform 0.4s ease-in-out';
                });
            }

            // Iniciar la carga de datos
            initializeApp();
            
            // Inicializar efectos adicionales
            initParallax();
            addScreenTransitions();
        });
        </script>
        
        <!-- Script para el manejo de la PWA -->
        <script src="js/app.js"></script>
    </body>
</html>
